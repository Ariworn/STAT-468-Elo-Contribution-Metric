[
  {
    "objectID": "05-Model.html",
    "href": "05-Model.html",
    "title": "6  Modelling Chapter",
    "section": "",
    "text": "so the idea is to use a Bayesian Hierarchical Model (partial pooling) that nests parameters inside parameters, and as such they are viewed as a sample from a probability distribution of parameters (taking a lot of this from pymc’s multilevel modelling module). In a completely pooled model we assume that \\(\\Delta\\) Elo.\nThis way we take into account differences in variation between our sampling units. In our context, the skill of a player realized in their ratings, can vary between each players in matches and this can handle the multicolinearity that exists between players that play with each other.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Modelling Chapter</span>"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Bayesian Modelling of Elo Contribution",
    "section": "",
    "text": "Preface\nThis is a Quarto book.\nTo learn more about Quarto books visit https://quarto.org/docs/books.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "1  Abstract",
    "section": "",
    "text": "The Motivating Idea\nElo generally represents the relative strength of a player or team compared to others by considering their past results. We are looking at elo for soccer clubs in the 2023-24 and 2024-25 premier league seasons.\n\\(\\Delta\\) Elo is defined as: the difference in elo before a match was played and the elo after a match was played for a premier league team. It represents the loss or gain of relative strength.\nUsing \\(\\Delta\\) Elo as our dependent variable, the idea is to use individual player ratings taken from a website that publishes these ratings, to model a player’s contribution to the delta elo in that match. This is similar to making an adjusted plus-minus model, and the current framework makes use of an idea from (Matano et al.) in their paper titled “Augmenting Adjusted Plus-Minus in Soccer with FIFA Ratings.” In it they reframe an Adjusted Plus Minus (APM) model framework into a Bayesian model by incorporating FIFA ratings into the prior distribution.\nSince Goal difference and delta_elo are similar, the idea is to use similar modelling. What we attempt to do is use a Bayesian Hierarchical Model to explain how much a players relative skill has an impact on their team’s \\(\\Delta\\) Elo.\nMore details about the model are found here: Modelling Chapter",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Abstract</span>"
    ]
  },
  {
    "objectID": "01-Import.html",
    "href": "01-Import.html",
    "title": "2  Import",
    "section": "",
    "text": "For the project here are all the list of packages that were installed and exist on the requirements.txt file.\n\n\nCode\n#Libraries used in the project\n#Basic libraries\nimport numpy as np\nimport pandas as pd\nfrom datetime import datetime\nfrom io import StringIO #yes\n#Data visualization libraries\nfrom lets_plot import *\nLetsPlot.setup_html()\nfrom great_tables import GT\nimport arviz as az\n#Web scraping libraries\nimport selenium as se\nfrom curl_cffi import requests\nfrom bs4 import BeautifulSoup\nimport time\n#For database connection and manipulation \nimport duckdb\n#For Hierarchical modeling\nimport pymc as pm\nimport xarray as xr\n#for pyshiny\nimport shiny\nimport requests as req\nimport vetiver\nimport pins\nimport logging \nimport json\nimport plotly.express as px\n\n\n\n            \n            \n            \n\n\nDatasets that were extracted/scraped and used with relevant considerations:\n\nFinding all the match fixtures that happened in the 2023/24 and 2024/25 seasons using this website: https://www.football-data.co.uk/englandm.php which has csv files for all the matches with home and away teams and the score line at the end of the match.\nWebscraping footballcritic to extract unique match_id in a particular season for each premier league team. For this the season_id was unique and was the ‘slug’ which has the season name and team names. Here is an example url https://www.footballcritic.com/premier-league/season-2024-2025/matches/2/72764\nGenerally the idea was to use the api to find club elo information from this website http://clubelo.com/. However, I encountered many problems with the final dataset clubelo also included premier league and champions league (and other european competition fixtures) and did not have a consistent daily elo dataset that could be used.\nInstead I created my own elo model using the methodology listed here: https://www.footballdatabase.com/methodology. Moreover, instead of starting at a baseline 1500 I used the preseason elo ratings from clubelo’s website that I manually extracted for each premier league club.\n\nHere are examples of how all datasets actually look like before tidying and transformation:\n\nFootball-data\n\n\n\nCode\nseason_23_24 = pd.read_csv('data/2023-24.csv')\nseason_24_25 = pd.read_csv('data/2024-25.csv')\nframes = [season_23_24, season_24_25]\nfull = pd.concat(frames)\nGT(full.head(5))\n\n\n\n\n\n\n\n\nDiv\nDate\nTime\nHomeTeam\nAwayTeam\nFTHG\nFTAG\nFTR\nHTHG\nHTAG\nHTR\nReferee\nHS\nAS\nHST\nAST\nHF\nAF\nHC\nAC\nHY\nAY\nHR\nAR\nB365H\nB365D\nB365A\nBWH\nBWD\nBWA\nIWH\nIWD\nIWA\nPSH\nPSD\nPSA\nWHH\nWHD\nWHA\nVCH\nVCD\nVCA\nMaxH\nMaxD\nMaxA\nAvgH\nAvgD\nAvgA\nB365&gt;2.5\nB365&lt;2.5\nP&gt;2.5\nP&lt;2.5\nMax&gt;2.5\nMax&lt;2.5\nAvg&gt;2.5\nAvg&lt;2.5\nAHh\nB365AHH\nB365AHA\nPAHH\nPAHA\nMaxAHH\nMaxAHA\nAvgAHH\nAvgAHA\nB365CH\nB365CD\nB365CA\nBWCH\nBWCD\nBWCA\nIWCH\nIWCD\nIWCA\nPSCH\nPSCD\nPSCA\nWHCH\nWHCD\nWHCA\nVCCH\nVCCD\nVCCA\nMaxCH\nMaxCD\nMaxCA\nAvgCH\nAvgCD\nAvgCA\nB365C&gt;2.5\nB365C&lt;2.5\nPC&gt;2.5\nPC&lt;2.5\nMaxC&gt;2.5\nMaxC&lt;2.5\nAvgC&gt;2.5\nAvgC&lt;2.5\nAHCh\nB365CAHH\nB365CAHA\nPCAHH\nPCAHA\nMaxCAHH\nMaxCAHA\nAvgCAHH\nAvgCAHA\nBFH\nBFD\nBFA\n1XBH\n1XBD\n1XBA\nBFEH\nBFED\nBFEA\nBFE&gt;2.5\nBFE&lt;2.5\nBFEAHH\nBFEAHA\nBFCH\nBFCD\nBFCA\n1XBCH\n1XBCD\n1XBCA\nBFECH\nBFECD\nBFECA\nBFEC&gt;2.5\nBFEC&lt;2.5\nBFECAHH\nBFECAHA\n\n\n\n\nE0\n11/08/2023\n20:00\nBurnley\nMan City\n0\n3\nA\n0\n2\nA\nC Pawson\n6\n17\n1\n8\n11\n8\n6\n5\n0\n0\n1\n0\n8.0\n5.5\n1.33\n8.75\n5.25\n1.34\n8.0\n5.5\n1.35\n8.58\n5.51\n1.37\n8.0\n5.0\n1.25\n9.5\n5.25\n1.33\n9.5\n5.68\n1.39\n9.02\n5.35\n1.35\n1.67\n2.2\n1.68\n2.29\n1.71\n2.4\n1.65\n2.27\n1.5\n1.86\n2.07\n1.86\n2.07\n1.93\n2.09\n1.85\n2.03\n9.0\n5.25\n1.33\n8.75\n5.25\n1.33\n8.5\n5.25\n1.35\n9.62\n5.81\n1.33\n7.5\n4.6\n1.29\n10.5\n5.25\n1.3\n10.5\n5.81\n1.36\n9.27\n5.45\n1.33\n1.67\n2.2\n1.65\n2.35\n1.73\n2.45\n1.64\n2.28\n1.5\n1.95\n1.98\n1.95\n1.97\n\n\n1.92\n1.95\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nE0\n12/08/2023\n12:30\nArsenal\nNott'm Forest\n2\n1\nH\n2\n0\nH\nM Oliver\n15\n6\n7\n2\n12\n12\n8\n3\n2\n2\n0\n0\n1.18\n7.0\n15.0\n1.17\n7.5\n15.5\n1.2\n7.25\n14.0\n1.18\n7.86\n15.67\n1.12\n6.5\n12.0\n1.14\n7.5\n17.0\n1.21\n8.5\n17.5\n1.18\n7.64\n15.67\n1.44\n2.75\n1.42\n2.93\n1.45\n2.98\n1.42\n2.85\n-2.0\n1.88\n2.02\n1.88\n2.01\n1.91\n2.06\n1.87\n1.99\n1.18\n7.0\n15.0\n1.18\n7.0\n14.5\n1.2\n7.0\n14.0\n1.19\n8.0\n16.0\n1.12\n6.5\n12.0\n1.22\n7.0\n13.0\n1.22\n8.4\n19.0\n1.19\n7.43\n15.98\n1.5\n2.63\n1.49\n2.65\n1.52\n2.79\n1.49\n2.63\n-2.0\n1.95\n1.98\n1.93\n1.97\n2.01\n2.09\n1.95\n1.92\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nE0\n12/08/2023\n15:00\nBournemouth\nWest Ham\n1\n1\nD\n0\n0\nD\nP Bankes\n14\n16\n5\n3\n9\n14\n10\n4\n1\n4\n0\n0\n2.7\n3.4\n2.55\n2.65\n3.4\n2.55\n2.7\n3.45\n2.6\n2.7\n3.47\n2.71\n2.62\n3.2\n2.3\n2.63\n3.3\n2.63\n2.8\n3.62\n2.75\n2.69\n3.44\n2.64\n1.9\n2.0\n1.9\n1.99\n1.95\n2.03\n1.88\n1.94\n0.0\n1.95\n1.95\n1.95\n1.95\n1.98\n1.99\n1.94\n1.92\n2.63\n3.5\n2.6\n2.65\n3.5\n2.5\n2.6\n3.5\n2.6\n2.75\n3.6\n2.63\n2.5\n3.2\n2.45\n2.63\n3.5\n2.6\n2.88\n3.67\n2.7\n2.7\n3.53\n2.59\n1.73\n2.1\n1.76\n2.18\n1.83\n2.23\n1.74\n2.12\n0.0\n2.02\n1.91\n2.01\n1.92\n2.06\n1.96\n1.96\n1.91\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nE0\n12/08/2023\n15:00\nBrighton\nLuton\n4\n1\nH\n1\n0\nH\nD Coote\n27\n9\n12\n3\n11\n12\n6\n7\n2\n2\n0\n0\n1.33\n5.5\n9.0\n1.32\n5.5\n9.0\n1.35\n5.25\n8.5\n1.33\n5.65\n9.61\n1.25\n4.6\n8.5\n1.29\n5.25\n10.0\n1.36\n6.0\n10.5\n1.33\n5.52\n9.61\n1.62\n2.3\n1.62\n2.4\n1.65\n2.45\n1.61\n2.34\n-1.5\n1.95\n1.95\n1.95\n1.95\n1.98\n2.0\n1.93\n1.93\n1.25\n6.5\n11.0\n1.26\n6.0\n11.0\n1.3\n5.5\n9.5\n1.27\n6.36\n11.36\n1.22\n5.5\n9.0\n1.25\n5.75\n13.0\n1.34\n6.59\n13.0\n1.28\n5.99\n10.91\n1.53\n2.5\n1.56\n2.54\n1.62\n2.66\n1.55\n2.48\n-1.75\n2.01\n1.92\n2.0\n1.91\n2.14\n1.93\n2.0\n1.86\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nE0\n12/08/2023\n15:00\nEverton\nFulham\n0\n1\nA\n0\n0\nD\nS Attwell\n19\n9\n9\n2\n12\n6\n10\n4\n0\n2\n0\n0\n2.2\n3.4\n3.3\n2.2\n3.4\n3.25\n2.25\n3.4\n3.25\n2.27\n3.45\n3.35\n2.1\n3.2\n3.0\n2.2\n3.3\n3.25\n2.3\n3.57\n3.45\n2.24\n3.43\n3.3\n2.01\n1.89\n2.0\n1.89\n2.04\n1.92\n1.97\n1.86\n-0.25\n1.93\n1.97\n1.95\n1.95\n1.97\n2.0\n1.92\n1.93\n2.3\n3.2\n3.2\n2.35\n3.2\n3.1\n2.35\n3.25\n3.15\n2.39\n3.32\n3.3\n2.1\n3.2\n3.0\n2.38\n3.2\n3.2\n2.42\n3.42\n3.56\n2.32\n3.28\n3.27\n2.1\n1.73\n2.23\n1.72\n2.26\n1.81\n2.17\n1.71\n-0.25\n2.06\n1.87\n2.04\n1.88\n2.08\n1.99\n1.98\n1.88\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nMatch_id from footballcritic\n\n\n\nCode\nMatch_info = pd.read_csv('data/team_match_ids_with_dates_and_comps.csv')\nGT(Match_info.head(5))\n\n\n\n\n\n\n\n\nteam_name\nteam_id\nseason\nseason_id\nmatch_id\ndate\ncompetition\n\n\n\n\nWolverhampton Wanderers FC\n459\nseason-2023-2024\n68731\n3009117\nAug 14, 2023\nEPL\n\n\nWolverhampton Wanderers FC\n459\nseason-2023-2024\n68731\n3009127\nAug 19, 2023\nEPL\n\n\nWolverhampton Wanderers FC\n459\nseason-2023-2024\n68731\n3009134\nAug 26, 2023\nEPL\n\n\nWolverhampton Wanderers FC\n459\nseason-2023-2024\n68731\n3131390\nAug 29, 2023\nFLC\n\n\nWolverhampton Wanderers FC\n459\nseason-2023-2024\n68731\n3009143\nSep 3, 2023\nEPL\n\n\n\n\n\n\n\n\n\nElo across seasons and matches\n\n\n\nCode\nelo = pd.read_csv('data/Elo_Table_Final.csv')\nGT(elo.head(5))\n\n\n\n\n\n\n\n\nseason_id\nmatch_id\ndate\nhome_team_id\naway_team_id\nold_home_elo\nold_away_elo\nnew_home_elo\nnew_away_elo\ndelta_home\ndelta_away\n\n\n\n\n68731\n3009108\n2023-08-11\n492\n464\n1726.4185791\n2080.86743164\n1716.5619319002355\n2090.7240788397644\n-9.856647199764438\n9.856647199764437\n\n\n68731\n3009114\n2023-08-12\n466\n461\n1887.082153\n1816.943237\n1902.4390321331364\n1801.586357866864\n15.356879133136228\n-15.356879133136228\n\n\n68731\n3009113\n2023-08-12\n480\n508\n1644.08129883\n1757.40673828\n1629.6563223701708\n1771.831714739829\n-14.424976459829114\n14.424976459829114\n\n\n68731\n3009112\n2023-08-12\n473\n460\n1699.523682\n1745.379028\n1682.204811369241\n1762.697898630759\n-17.31887063075889\n17.31887063075889\n\n\n68731\n3009111\n2023-08-12\n510\n502\n1832.391968\n1602.344727\n1839.2232295331976\n1595.513465466802\n6.8312615331978925\n-6.8312615331978925\n\n\n\n\n\n\n\n\n\nPlayer ratings webscraped from footballcritic\n\n\n\nCode\nall_ratings = pd.read_csv('data/player_ratings.csv')\nGT(all_ratings.head(5))\n\n\n\n\n\n\n\n\nMatch ID\nTeam ID\nPlayer\nRating\n\n\n\n\n3009117\n475\nA. Onana\n8.2\n\n\n3009117\n475\nA. W-Bissaka\n7.6\n\n\n3009117\n475\nR. Varane\n7.4\n\n\n3009117\n475\nL. Martínez\n6.1\n\n\n3009117\n475\nL. Shaw\n7.2",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Import</span>"
    ]
  }
]